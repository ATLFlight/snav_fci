<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Snapdragon Navigator Flight Control Interface: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Snapdragon Navigator Flight Control Interface
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Snapdragon Navigator Flight Control Interface Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Table of Contents</h2>
<ol type="1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#version-compatibility">Version Compatibility</a></li>
<li><a href="#cloning-and-building-the-code">Cloning and building the code</a></li>
<li><a href="#running-the-examples">Running the examples</a></li>
<li><a href="#generating-the-documentation">Generating the documentation</a></li>
<li><a href="#faq">FAQ</a></li>
</ol>
<h2>Introduction</h2>
<p>Snapdragon Navigator<sup>TM</sup> is a flight controller that runs on the Qualcomm Snapdragon Flight<sup>TM</sup> platform. Detailed information about its capabilities can be found on the <a href="https://developer.qualcomm.com/hardware/snapdragon-flight/sd-navigator">Qualcomm Developer Network site</a>.</p>
<p><a href="https://github.com/ATLFlight/snav_fci">Snapdragon Navigator Flight Control Interface</a> is an example of an abstraction layer between the Snapdragon Navigator API and higher-level programs. It is intended to isolate application developers from certain low-level details of the Snapdragon Navigator API.</p>
<p>To get started with the documentation, see <a href="https://github.com/pages/ATLFlight/snav_fci/classsnav__fci_1_1_flight_control_interface.html">snav_fci::FlightControlInterface</a>.</p>
<p>Several examples are provided to demonstrate how to use FlightControlInterface:</p>
<ul>
<li><a href="https://github.com/ATLFlight/snav_fci/blob/master/examples/hello_snav.cpp">hello_snav.cpp</a></li>
<li><a href="https://github.com/ATLFlight/snav_fci/blob/master/examples/basic_waypoint_example.cpp">basic_waypoint_example.cpp</a></li>
<li><a href="https://github.com/ATLFlight/snav_fci/blob/master/examples/multithreaded_waypoint_example.cpp">multithreaded_waypoint_example.cpp</a></li>
<li><a href="https://github.com/ATLFlight/snav_fci/blob/master/examples/orbit_example.cpp">orbit_example.cpp</a></li>
</ul>
<h2>Prerequisites</h2>
<h3>Hardware</h3>
<p>This example requires the following hardware:</p>
<ul>
<li><a href="https://shop.intrinsyc.com/collections/product-development-kits/products/qualcomm-snapdragon-flight-sbc">Qualcomm Snapdragon Flight Kit</a></li>
<li><a href="https://shop.intrinsyc.com/collections/dragonboard-accessories/products/qualcomm-electronic-speed-control-board">Qualcomm Electronic Speed Control (ESC) board</a></li>
<li>Drone frame, motors, and propellers; such as the <a href="https://worldsway.com/product/dragon-drone-development-kit/">Dragon Drone Development Kit</a></li>
</ul>
<p>Note that if you're using the Dragon DDK, a URDF ros package is available at: <a href="https://github.com/ATLFlight/dragon_ddk_description">dragon_ddk_description</a></p>
<h3>Software</h3>
<p>This example requires the following software:</p>
<ul>
<li><a href="https://support.intrinsyc.com/attachments/download/1597/Flight_3.1.3.1_JFlash.zip">Plaform Image from Intrynsic 3.1.3.1</a></li>
<li><a href="https://support.intrinsyc.com/attachments/download/1571/Flight_3.1.3.1_qcom_flight_controller_hexagon_sdk_add_on.zip">Platform Addon from Intrynsic 3.1.3.1</a></li>
<li><a href="https://developer.qualcomm.com/download/snapdragon-flight/navigator-v1.2.53.1.deb">Qualcomm Snapdragon Navigator Flight Controller SDK 1.2.53.1</a></li>
<li><a href="https://developer.qualcomm.com/download/machine-vision/machine-vision-sdk-v1.1.4.deb">Qualcomm Machine Vision SDK 1.1.4</a></li>
<li><a href="https://developer.qualcomm.com/download/snapdragon-flight/navigator-controller-esc-firmware-v1.2.0">Qualcomm Snapdragon ESC Firmware 1.2.0</a></li>
<li>CMake: install on target with <code>sudo apt-get install cmake</code></li>
<li>Eigen: install on target with <code>sudo apt-get install libeigen3-dev</code></li>
</ul>
<h2>Version Compatibility</h2>
<p>The table below summarizes what versions of Snapdragon Navigator are compatible with a given release of Flight Control Interface.</p>
<table class="doxtable">
<tr>
<th>Flight Control Interface Version </th><th>Snapdragon Navigator Version  </th></tr>
<tr>
<td>v1.0 </td><td>&gt;= v1.2.53.1 </td></tr>
</table>
<h2>Cloning and building the code</h2>
<p>These instructions assume that your Snapdragon Flight board is connected to the internet, but, alternatively, you can clone this repo on an internet-connected computer and then push the files to your Snapdragon Flight board. These instructions also assume that the compilation is done on the Snapdragon Flight board.</p>
<h3>Clone this repo</h3>
<pre class="fragment">adb shell
cd /home/linaro
git clone https://github.com/ATLFlight/snav_fci.git
</pre><h3>Build the code</h3>
<pre class="fragment">cd snav_fci
mkdir build
cd build
cmake ..
make -j4
</pre><p>A library called <code>libsnav_fci.so</code> is built and put in the <code>lib</code> directory. Examples appear in the <code>bin</code> directory.</p>
<h2>Running the examples</h2>
<h3>Running Snapdragon Navigator simulator</h3>
<p>It is a good idea to test the examples in simulation before attempting any real flights. In general, this is a powerful way to test API programs without risking damage to any vehicles or the environment that could be caused in a real flight test. To do this, run <code>snav</code> in simulation mode: </p>
<pre class="fragment">sudo stop snav
sudo snav -w 1000
</pre><p>Although the motors do not spin in simulation mode, it is still prudent to remove the propellers while doing bench-top testing to avoid accidents.</p>
<h3>Test communication with Snapdragon Navigator</h3>
<p>From another shell, run the <code>hello_snav</code> example to test whether or not you are able to communicate with Snapdragon Navigator. </p>
<pre class="fragment">cd /home/linaro/snav_fci/build/bin
./hello_snav
</pre><p>You should see a message print out about successfully connecting to Snapdragon Navigator, and, if you have ESCs and motors connected, you should observe the status LEDs changing color and hear beeps indicating that Snapdragon Navigator started receiving commands.</p>
<p>For example, here is the output from a successful run (output is identical for both sim and non-sim): </p>
<pre class="fragment">linaro@linaro-developer:~/snav_fci/build/bin$ ./hello_snav
The apps &lt;--&gt; dsp offset = [1513353394762546617 ](ns) Apps ClockType[CLOCK_REALTIME]
[INFO] Launched tx thread (id: 3020944384)
[INFO] Launched rx thread (id: 3012555776)
Successfully connected to Snapdragon Navigator
[INFO] tx thread terminated normally
[INFO] rx thread terminated normally
</pre><p>Running this example successfully confirms that the flight stack is running normally and is accepting API commands. This is a good sanity test of your installation of Snapdragon Navigator and Flight Control Interface.</p>
<h3>Test example programs in simulation with snav_inspector</h3>
<p>With Snapdragon Navigator running in simulation mode, you can run any of the examples and observe the live simulated results using <code>snav_inspector</code>, a tool included in the Snapdragon Navigator package. For more information on how to use this tool, please refer to the <a href="https://developer.qualcomm.com/hardware/snapdragon-flight/sd-navigator/tools">Snapdragon Navigator User Guide</a>.</p>
<p>For example, run the <code>basic_waypoint_example</code> program and observe the <code>pos_vel</code> group in <code>snav_inspector</code>. You should observe the <code>pos_vel.position_estimated</code> field tracking the <code>pos_vel.position_desired</code> field as the simulated vehicle executes the waypoint mission.</p>
<h3>Visualize simulated flight using ROS and rviz</h3>
<p>You can also test the example programs by visualizing the simulated flight in <code>rviz</code> using ROS. You can use <code>snav_ros</code> to accomplish this. Follow the instructions in the <a href="https://github.com/ATLFlight/snav_ros">snav_ros</a> https://github.com/ATLFlight/snav_ros/blob/master/README.md "README" to get up and running.</p>
<h3>Real flight test</h3>
<p>Once you are confident that the example programs are working properly in simulation, you can perform a real flight test. Kill the <code>snav</code> simulator and start <code>snav</code> normally with the <code>start snav</code> command.</p>
<p>Before running any of the programs, place the vehicle on flat ground that has plenty of visual texture. Make sure there is plenty of open space in all directions. If you have a Spektrum RC, be prepared to take over in the event of an anomaly.</p>
<h2>Generating the documentation</h2>
<p>Doxygen is used to generate documentation for this repo. You can generate it yourself as follows: </p>
<pre class="fragment">cd /home/linaro/snav_fci
doxygen Doxyfile
</pre><p>Autogenerated HTML files are put in the <code>docs</code> directory and can be viewed using a web browser. Simply open <code>index.html</code> in a browser to get started.</p>
<h2>FAQ</h2>
<h3>I am getting an error message about not being able to initialize SnavCachedData</h3>
<p>The following error message usually indicates that Snapdragon Navigator is not actively running: </p>
<pre class="fragment">Update checksum_failure. [f0eb75d8,a4d0a2d1] Possible RPC issue.
[ERROR] int snav_fci::FlightControlInterface::initialize(snav_fci::FlightControlInterface::Permissions) -- could not init SnavCachedData
</pre><p>Start Snapdragon Navigator using the <code>start snav</code> command for normal operation or the <code>snav -w</code> command for simulation and then rerun the program. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 17 2018 14:45:16 for Snapdragon Navigator Flight Control Interface by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
